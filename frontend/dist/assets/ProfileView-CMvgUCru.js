import{_ as N,u as T,r as a,c as t,b as s,e as C,w,v as y,t as v,a as i,i as B,F as I,g as V,h,q as D,o as l,d as M,m as k}from"./index-Dn0hYYMP.js";import{T as G}from"./ToastNotification-C6JxJPdt.js";const L={class:"profile-page"},R={class:"profile-main"},j={class:"profile-container"},H={class:"form-group"},J={key:0,class:"error-text"},K={class:"form-group"},O={key:0,class:"error-text"},Q={class:"form-group"},W={key:0,class:"error-text"},X={class:"form-group"},Y={key:0,class:"error-text"},Z={class:"form-group"},$={key:0,class:"error-text"},ee={class:"form-group"},se={key:0,class:"error-text"},re={class:"profile-sidebar"},oe={class:"profile-container"},ae={class:"product-actions"},te={class:"profile-container"},le={class:"product-actions",style:{"margin-top":"10px"}},ne={key:0,class:"error-text d-block mt-2"},ue={__name:"ProfileView",setup(ie){const b=T(),g=a({...b.user}),n=a({current_password:"",password:"",password_confirmation:""}),E=a({password:""}),f=a({}),u=a({}),_=a({}),d=a(null),p=a(""),c=a("success"),P=async()=>{f.value={};try{const r=await k.patch("/profile",g.value);b.setUser(r.data.data),p.value="Perfil actualizado correctamente.",c.value="success",d.value.show()}catch(r){r.response&&r.response.data.errors?f.value=r.response.data.errors:(p.value="Error al actualizar el perfil.",c.value="error",d.value.show())}},q=async()=>{u.value={};try{await k.put("/password",n.value),p.value="Contraseña actualizada correctamente.",c.value="success",d.value.show(),n.value={current_password:"",password:"",password_confirmation:""}}catch(r){r.response&&r.response.data.errors?u.value=r.response.data.errors:(p.value="Error al actualizar la contraseña.",c.value="error",d.value.show())}},A=async()=>{if(confirm("¿Estás seguro de que quieres eliminar tu cuenta? Esta acción no se puede deshacer.")){_.value={};try{await k.delete("/profile",{data:E.value}),await b.logout(!1)}catch(r){r.response&&r.response.data.errors?_.value=r.response.data.errors:(p.value="Error al eliminar la cuenta.",c.value="error",d.value.show())}}},S=async()=>{await b.logout()},x=a(null),m=a(""),U=r=>{x.value=r.target.files[0],m.value=""},z=async()=>{if(!x.value){m.value="Por favor, selecciona un archivo.";return}const r=new FormData;r.append("file",x.value);try{await k.post("/products/import",r,{headers:{"Content-Type":"multipart/form-data"}}),p.value="Productos importados correctamente.",c.value="success",d.value.show(),x.value=null;const e=document.querySelector(".file-input");e&&(e.value="")}catch(e){console.error(e),e.response&&e.response.data.errors&&e.response.data.errors.file?m.value=e.response.data.errors.file[0]:e.response&&e.response.data.message?m.value=e.response.data.message:m.value="Error al importar productos."}};return(r,e)=>{const F=D("RouterLink");return l(),t("div",L,[s("div",R,[s("div",j,[e[18]||(e[18]=s("h2",null,"Editar Perfil",-1)),s("section",null,[e[9]||(e[9]=s("header",null,[s("h3",null,"Información del Perfil"),s("p",{class:"description"},"Actualiza la información de tu perfil y la dirección de correo electrónico.")],-1)),s("form",{onSubmit:C(P,["prevent"]),class:"mt-6 space-y-6"},[s("div",H,[e[6]||(e[6]=s("label",{for:"name"},"Nombre",-1)),w(s("input",{id:"name",type:"text","onUpdate:modelValue":e[0]||(e[0]=o=>g.value.name=o),class:"form-control",required:"",autofocus:"",autocomplete:"name"},null,512),[[y,g.value.name]]),f.value.name?(l(),t("span",J,v(f.value.name[0]),1)):i("",!0)]),s("div",K,[e[7]||(e[7]=s("label",{for:"email"},"Email",-1)),w(s("input",{id:"email",type:"email","onUpdate:modelValue":e[1]||(e[1]=o=>g.value.email=o),class:"form-control",required:"",autocomplete:"username"},null,512),[[y,g.value.email]]),f.value.email?(l(),t("span",O,v(f.value.email[0]),1)):i("",!0)]),e[8]||(e[8]=s("div",{class:"form-actions"},[s("button",{type:"submit",class:"btn-primary"},"Guardar")],-1))],32)]),e[19]||(e[19]=s("div",{class:"section-divider"},null,-1)),s("section",null,[e[14]||(e[14]=s("header",null,[s("h3",null,"Actualizar Contraseña"),s("p",{class:"description"},"Asegúrate de que tu cuenta esté usando una contraseña larga y aleatoria para mantenerla segura.")],-1)),s("form",{onSubmit:C(q,["prevent"]),class:"mt-6 space-y-6"},[s("div",Q,[e[10]||(e[10]=s("label",{for:"current_password"},"Contraseña Actual",-1)),w(s("input",{id:"current_password",type:"password","onUpdate:modelValue":e[2]||(e[2]=o=>n.value.current_password=o),class:"form-control",autocomplete:"current-password"},null,512),[[y,n.value.current_password]]),u.value.current_password?(l(),t("span",W,v(u.value.current_password[0]),1)):i("",!0)]),s("div",X,[e[11]||(e[11]=s("label",{for:"password"},"Nueva Contraseña",-1)),w(s("input",{id:"password",type:"password","onUpdate:modelValue":e[3]||(e[3]=o=>n.value.password=o),class:"form-control",autocomplete:"new-password"},null,512),[[y,n.value.password]]),u.value.password?(l(),t("span",Y,v(u.value.password[0]),1)):i("",!0)]),s("div",Z,[e[12]||(e[12]=s("label",{for:"password_confirmation"},"Confirmar Contraseña",-1)),w(s("input",{id:"password_confirmation",type:"password","onUpdate:modelValue":e[4]||(e[4]=o=>n.value.password_confirmation=o),class:"form-control",autocomplete:"new-password"},null,512),[[y,n.value.password_confirmation]]),u.value.password_confirmation?(l(),t("span",$,v(u.value.password_confirmation[0]),1)):i("",!0)]),e[13]||(e[13]=s("div",{class:"form-actions"},[s("button",{type:"submit",class:"btn-primary"},"Guardar")],-1))],32)]),e[20]||(e[20]=s("div",{class:"section-divider"},null,-1)),s("section",null,[e[17]||(e[17]=s("header",null,[s("h3",null,"Borrar Cuenta"),s("p",{class:"description"},"Una vez que se elimine tu cuenta, todos sus recursos y datos se eliminarán permanentemente.")],-1)),s("form",{onSubmit:C(A,["prevent"]),class:"mt-6 space-y-6"},[s("div",ee,[e[15]||(e[15]=s("label",{for:"delete_password"},"Contraseña",-1)),w(s("input",{id:"delete_password",type:"password","onUpdate:modelValue":e[5]||(e[5]=o=>E.value.password=o),class:"form-control",placeholder:"Contraseña"},null,512),[[y,E.value.password]]),_.value.password?(l(),t("span",se,v(_.value.password[0]),1)):i("",!0)]),e[16]||(e[16]=s("div",{class:"form-actions"},[s("button",{type:"submit",class:"btn-danger"},"Borrar Cuenta")],-1))],32)])])]),s("div",re,[s("div",{class:"profile-container"},[e[21]||(e[21]=s("h3",null,"Cerrar Sesión",-1)),s("button",{onClick:S,class:"btn-secondary w-full"},"Cerrar sesión")]),B(b).isAdmin?(l(),t(I,{key:0},[s("div",oe,[e[23]||(e[23]=s("h3",{class:"add-product"},"Añadir producto",-1)),s("div",ae,[V(F,{to:"/products/create",class:"btn-secondary w-full text-center d-block",style:{"text-decoration":"none",display:"block"}},{default:h(()=>[...e[22]||(e[22]=[M(" Añadir Producto ",-1)])]),_:1})])]),s("div",te,[e[25]||(e[25]=s("h3",null,"Importar productos desde Excel",-1)),s("div",le,[s("form",{onSubmit:C(z,["prevent"])},[s("input",{type:"file",onChange:U,required:"",class:"file-input w-full",accept:".xlsx, .csv, .xls"},null,32),m.value?(l(),t("span",ne,v(m.value),1)):i("",!0),e[24]||(e[24]=s("button",{type:"submit",class:"btn-secondary w-full mt-2",style:{"margin-top":"10px"}}," Importar ",-1))],32)])])],64)):i("",!0)]),V(G,{ref_key:"toast",ref:d,message:p.value,type:c.value},null,8,["message","type"])])}}},ce=N(ue,[["__scopeId","data-v-fd0cca36"]]);export{ce as default};
